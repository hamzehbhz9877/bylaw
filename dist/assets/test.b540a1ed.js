import{r as g,h as b,e as I,i as C,k as q,j as c,b as h,F as S}from"./index.0069aa58.js";import{Q as N,a as k}from"./body.5842f1b9.js";import"./isimage.c1c7af8e.js";const Q=({min:e,sec:i,timeOutFunc:l})=>{const[s,t]=g.exports.useState(e),[n,r]=g.exports.useState(i);return g.exports.useEffect(()=>{t(e),r(i)},[e,i]),g.exports.useEffect(()=>{let u=setInterval(()=>{n>0&&r(n-1),n===0&&(s===0?(l(),clearInterval(u)):(t(s-1),r(59)))},1e3);return()=>{clearInterval(u)}}),{minutes:s,seconds:n}};const T=({data:e})=>{const i=()=>{let t=[];if(e!=null&&e.questions){for(var n=0;n<(e==null?void 0:e.questions.length);n++)for(var r=document.getElementsByName(`radioCheck${e==null?void 0:e.questions[n]._id}`),u=0;u<r.length;u++)if(r[u].checked){t.push({questionId:e==null?void 0:e.questions[n]._id,optionSelected:Number(r[u].value)});break}}return{testId:e==null?void 0:e._id,correctOption:t}},l=()=>{const t=JSON.parse(localStorage.getItem("answeredQuestion"));if(t)for(var n=0;n<(t==null?void 0:t.length);n++){var r=document.querySelector(`[name=radioCheck${t[n].questionId}][data-sld=d-${t[n].optionSelected}]`);r&&(r.checked=!0)}},s=t=>{t.preventDefault(),localStorage.setItem("answeredQuestion",JSON.stringify(i().correctOption))};return g.exports.useEffect(()=>(e&&(l(),window.addEventListener("beforeunload",s)),()=>{window.removeEventListener("beforeunload",s)}),[e]),{getCheck:i}},_=()=>{var v,d,p,a;const[e,i]=b(),l=I(),{data:s,isLoading:t}=C({event:q,eventOption:{queryKey:["getRandomQuestion",e.get("id")]},values:(v=localStorage.getItem("currentTestId"))!=null?v:e.get("id"),options:{cacheTime:0,onSuccess:o=>{var m;((m=o.questions)==null?void 0:m.length)>0?(localStorage.setItem("currentTestId",o._id),i({id:o._id})):localStorage.removeItem("currentTestId")}}}),{getCheck:n}=T({data:s}),r=async()=>{const o=n();localStorage.removeItem("answeredQuestion"),console.log(o),l("/result",{replace:!0,state:o})},{minutes:u,seconds:f}=Q({min:Number((d=s==null?void 0:s.remindTime)==null?void 0:d.split(":")[0]),sec:Number((p=s==null?void 0:s.remindTime)==null?void 0:p.split(":")[1]),timeOutFunc:r});return t?c("div",{children:"\u062F\u0631 \u062D\u0627\u0644 \u0628\u0627\u0631\u06AF\u06CC\u0631\u06CC \u0633\u0648\u0627\u0644\u0627\u062A..."}):h(S,{children:[(a=s==null?void 0:s.questions)==null?void 0:a.map((o,m)=>h("div",{className:"question card bg-light mb-3",children:[c(N,{title:o.title,index:m}),c(k,{data:o,isFinished:!1})]},m)),!!(s!=null&&s.questions.length)&&s.questions.length>0&&h(S,{children:[h("div",{className:"btn btn-warning test__remaining-time",children:[c("h6",{children:"\u0632\u0645\u0627\u0646 \u0628\u0627\u0642\u06CC\u0645\u0627\u0646\u062F\u0647 \u0622\u0632\u0645\u0648\u0646"}),c("span",{children:h("b",{children:[u<10?`0${u}`:u,":",f<10?`0${f}`:f]})})]}),c("div",{className:"text-center",children:c("button",{className:"btn btn-success",onClick:r,children:"\u067E\u0627\u06CC\u0627\u0646 \u0622\u0632\u0645\u0648\u0646"})})]})]})};export{_ as default};
